<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">

        <link rel="icon" href="assets/favicon.ico">
        <title>零碎月报</title>

        <!-- 字体reference -->
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;300;400;500;700;900&family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap" rel="stylesheet">

        <!-- Bootstrap core CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom styles for this template -->
        <link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
        <link href="css/blog.css" rel="stylesheet">
        <link href="css/scrolly.css" rel="stylesheet">

    </head>

    <body>
        <div class="container">
            <header class="blog-header py-3">
                <div class="row flex-nowrap justify-content-between align-items-center">
                    <div class="col-4">
                        <a class="blog-header-logo text-dark" href="#">△ 零碎月报</a>
                    </div>
                </div>
            </header>
        </div>

        <main role="main" class="container">
            <div class="blog-post">
                <h2 class="blog-post-title">偶像选秀的分组真的公平吗？</h2>
                <p class="blog-post-meta">2020年10月</p>

                <div class="blog-content">
                    <p>到底是选曲捧人，还是人捧选曲，一直是我看选秀综艺的迷思之一。</p>

                    <p>今年的《青春有你2》，我基本上是跟着微博热搜追过来的，许多选手的舞台表现真的非常出色。但是，直到最近打开某音乐app才发现，原来这档节目远不止那几首曲子。</p>

                    <p>这就让我联想到另一个问题：偶像选秀中是否存在“弃曲”和“黄金选曲”？</p>

                    <section id="scrolly">
                        <figure>
                            <p>0</p>
                        </figure>

                        <article>
                            <div class="step" data-step="1">
                                <p>STEP 1</p>
                            </div>

                            <div class="step" data-step="2">
                                <p>STEP 2</p>
                            </div>

                            <div class="step" data-step="3">
                                <p>STEP 3</p>
                            </div>
                            
                            <div class="step" data-step="4">
                                <p>STEP 4</p>
                            </div>
                        </article>
                    </section>

                    <section id="outro"></section>

                    <hr/>


                </div>
            </div>
        </main>

        <!-- <div class='debug'></div> -->
        <script src="https://unpkg.com/d3@5.9.1/dist/d3.min.js"></script>
        <script src="https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js"></script>
        <script src="js/stickyfill.min.js"></script>
        <script src="js/scrollama.min.js"></script>
        <script>
            // using d3 for convenience
            var main = d3.select("main");
            var scrolly = main.select("#scrolly");
            var figure = scrolly.select("figure");
            var article = scrolly.select("article");
            var step = article.selectAll(".step");

            // initialize the scrollama
            var scroller = scrollama();

            // generic window resize listener event
            function handleResize() {
            // 1. update height of step elements
            var stepH = Math.floor(window.innerHeight * 0.75);
            step.style("height", stepH + "px");

            var figureHeight = window.innerHeight / 2;
            var figureMarginTop = (window.innerHeight - figureHeight) / 2;

            figure
              .style("height", figureHeight + "px")
              .style("top", figureMarginTop + "px");

            // 3. tell scrollama to update new element dimensions
            scroller.resize();
            }

            // scrollama event handlers
            function handleStepEnter(response) {
            console.log(response);
            // response = { element, direction, index }

            // add color to current step only
            step.classed("is-active", function(d, i) {
              return i === response.index;
            });

            // update graphic based on step
            figure.select("p").text(response.index + 1);
            }

            function setupStickyfill() {
            d3.selectAll(".sticky").each(function() {
              Stickyfill.add(this);
            });
            }

            function init() {
            setupStickyfill();

            // 1. force a resize on load to ensure proper dimensions are sent to scrollama
            handleResize();

            // 2. setup the scroller passing options
            //      this will also initialize trigger observations
            // 3. bind scrollama event handlers (this can be chained like below)
            scroller
              .setup({
                step: "#scrolly article .step",
                offset: 0.33,
                // debug: true
              })
              .onStepEnter(handleStepEnter);

            // setup resize event
            window.addEventListener("resize", handleResize);
            }

            // kick things off
            init();

        </script>

    </body>
</html>
